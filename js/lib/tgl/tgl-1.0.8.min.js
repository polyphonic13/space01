/* TreSensa Game Loader Version 1.0.8 */ 
/* Copyright (c) 2013 TreSensa, Inc. All Rights Reserved. */

var TGL=TGL||{},_gaq=_gaq||[],_qevents=_qevents||[];TGL.Debug=TGL.Debug||{};TGL.Debug.LOG_NONE=0;TGL.Debug.LOG_ERROR=1;TGL.Debug.LOG_WARNING=2;TGL.Debug.LOG_INFO=3;TGL.Debug.LOG_VERBOSE=4;TGL.Debug.LogLevel=TGL.Debug.LOG_NONE;TGL.Debug.Log=function(b){if(window.console&&b<=TGL.Debug.LogLevel){var a="TGL: ";if(b===TGL.Debug.LOG_ERROR){a+="**ERROR** "}window.console.log(a+Array.prototype.slice.call(arguments,1))}};TGL.RanGame=false;(function(){if(typeof GameConfig.LOG_LEVEL==="number"){TGL.Debug.LogLevel=GameConfig.LOG_LEVEL}TGL.Debug.Log(TGL.Debug.LOG_INFO,"GameConfig.js loaded");GameConfig.NATIVE_APP=!(typeof CordovaConfig==="undefined");if(GameConfig.NATIVE_APP){TGL.Debug.Log(TGL.Debug.LOG_INFO,"Native app detected")}if(typeof GameConfig.HOST==="undefined"||typeof GameConfig.PATH==="undefined"||typeof GameConfig.VERSION==="undefined"||typeof GameConfig.TGE.VERSION==="undefined"||typeof GameConfig.TGS.VERSION==="undefined"||typeof GameConfig.CONSTRUCTOR==="undefined"){TGL.Debug.Log(TGL.Debug.LOG_ERROR,"GameConfig.HOST, PATH, VERSION, TGE.VERSION, TGS.VERSION, and CONSTRUCTOR are required properties and must be defined");return}if(GameConfig.NATIVE_APP){if(CordovaConfig.GoogleAnalytics.NATIVE_ID==="undefined"||CordovaConfig.GoogleAnalytics.NATIVE_ID==""){TGL.Debug.Log(TGL.Debug.LOG_ERROR,"CordovaConfig.GoogleAnalytics.NATIVE_ID is required for native app builds");return}else{GameConfig.GoogleAnalytics.NATIVE_ID=CordovaConfig.GoogleAnalytics.NATIVE_ID}}if(GameConfig.NATIVE_APP&&(GameConfig.GameCenter.LEADERBOARD_ID==="undefined"||GameConfig.GameCenter.LEADERBOARD_ID=="")){TGL.Debug.Log(TGL.Debug.LOG_ERROR,"GameConfig.GoogleAnalytics.NATIVE_ID is required for native app builds");return}if((GameConfig.DEBUG||!GameConfig.PROD_ENV)&&(typeof GameConfig.SOURCE==="undefined"||GameConfig.SOURCE.length==0)){TGL.Debug.Log(TGL.Debug.LOG_ERROR,"GameConfig.SOURCE is required when not running in production");return}GameConfig.PROD_ENV=typeof(GameConfig.PROD_ENV)!=="undefined"?GameConfig.PROD_ENV:false;GameConfig.ORIENTATION=typeof(GameConfig.ORIENTATION)!=="undefined"?GameConfig.ORIENTATION:"portrait";GameConfig.CANVAS_ID=typeof(GameConfig.CANVAS_ID)!=="undefined"?GameConfig.CANVAS_ID:"game_canvas";GameConfig.REORIENT_ID=typeof(GameConfig.REORIENT_ID)!=="undefined"?GameConfig.REORIENT_ID:"wrong_orientation";GameConfig.PRELOADER_DIV=typeof(GameConfig.PRELOADER_DIV)!=="undefined"?GameConfig.PRELOADER_DIV:"preloader";GameConfig.TGE.ENABLED=typeof(GameConfig.TGE.ENABLED)!=="undefined"?GameConfig.TGE.ENABLED:true;GameConfig.TGE.FONT_LOADER=typeof(GameConfig.TGE.FONT_LOADER)!=="undefined"?GameConfig.TGE.FONT_LOADER:false;GameConfig.DEBUG=typeof(GameConfig.DEBUG)!=="undefined"?GameConfig.DEBUG:false;GameConfig.CDN.ENABLED=typeof(GameConfig.CDN.ENABLED)!=="undefined"?GameConfig.CDN.ENABLED:false;GameConfig.TGS.ENABLED=typeof(GameConfig.TGS.ENABLED)!=="undefined"?GameConfig.TGS.ENABLED:true;GameConfig.ADS.SERVER=typeof(GameConfig.ADS.SERVER)!=="undefined"?GameConfig.ADS.SERVER:"adtech";GameConfig.Playnomics.ENABLED=typeof(GameConfig.Playnomics.ENABLED)!=="undefined"?GameConfig.Playnomics.ENABLED:false;GameConfig.Quantcast.ENABLED=typeof(GameConfig.Quantcast.ENABLED)!=="undefined"?GameConfig.Quantcast.ENABLED:false;if(GameConfig.PROD_ENV){GameConfig.TGS.HOST=typeof(GameConfig.TGS.HOST)!=="undefined"?GameConfig.TGS.HOST:"tgs.tresensa.com"}else{GameConfig.TGS.HOST="stg-tgs.tresensa.com"}GameConfig.TGS.ASYNC_LOAD=typeof(GameConfig.TGS.ASYNC_LOAD)!=="undefined"?GameConfig.TGS.ASYNC_LOAD:false;var b=[],a="",f=GameConfig.PROD_ENV?"//static.tresensa.com":"//qa-static.tresensa.com",d="",e=".min",c="assets";if(GameConfig.DEBUG){a="js/lib-debug/";d="";GameConfig.IMAGE_ROOT=GameConfig.CDN_ROOT=c+"/";GameConfig.AUDIO_ROOT=GameConfig.HOST+GameConfig.PATH+GameConfig.IMAGE_ROOT}else{if(!GameConfig.NATIVE_APP&&GameConfig.CDN.ENABLED){a="//static.tresensa.com/lib/";d=f+GameConfig.PATH;GameConfig.IMAGE_ROOT=GameConfig.CDN_ROOT=f+GameConfig.PATH+c+"-"+GameConfig.VERSION+"/";GameConfig.AUDIO_ROOT=GameConfig.CDN_ROOT}else{if(GameConfig.NATIVE_APP){a="js/lib/";d="";GameConfig.IMAGE_ROOT=GameConfig.CDN_ROOT=c+"/";GameConfig.AUDIO_ROOT="http:"+f+GameConfig.PATH+c+"-"+GameConfig.VERSION+"/"}else{a="js/lib/";d="";GameConfig.IMAGE_ROOT=GameConfig.CDN_ROOT=c+"/";GameConfig.AUDIO_ROOT=GameConfig.CDN_ROOT}}}if(GameConfig.DEBUG){e=""}GameConfig.APP_URL=GameConfig.HOST+GameConfig.PATH;if(!GameConfig.NATIVE_APP){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"Game hosted at "+GameConfig.APP_URL)}TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,'sdkBaseURL = "'+a+'"');TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,'gameBaseURL = "'+d+'"');TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,'GameConfig.IMAGE_ROOT = "'+GameConfig.IMAGE_ROOT+'"');TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,'GameConfig.AUDIO_ROOT = "'+GameConfig.AUDIO_ROOT+'"');TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,'minifiedSetting = "'+e+'"');TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,'TGS Server = "'+GameConfig.TGS.HOST+'"');if(GameConfig.NATIVE_APP){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,'Google Analytics ID = "'+GameConfig.GoogleAnalytics.NATIVE_ID+'"')}else{if(GameConfig.PROD_ENV){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,'Google Analytics ID = "'+GameConfig.GoogleAnalytics.PROD_ID+'"')}else{TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,'Google Analytics ID = "'+GameConfig.GoogleAnalytics.QA_ID+'"')}}if(GameConfig.ORIENTATION==="landscape"){GameConfig.WIDTH=960;GameConfig.HEIGHT=536}else{GameConfig.WIDTH=640;GameConfig.HEIGHT=832}TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"Game screen orientation = "+GameConfig.ORIENTATION);TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"Game width = "+GameConfig.WIDTH+", height = "+GameConfig.HEIGHT);if(GameConfig.NATIVE_APP){TGL.Debug.Log(TGL.Debug.LOG_INFO,"Loading the Cordova libs defined in CordovaConfig.js");CordovaConfig.LIBS.forEach(function(g){b.push(g);TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"Cordova lib: "+g)})}if(!GameConfig.NATIVE_APP&&GameConfig.GoogleAnalytics.ENABLED){TGL.Debug.Log(TGL.Debug.LOG_INFO,"Google Analytics enabled");(function(){var h=document.createElement("script");h.type="text/javascript";h.async=true;h.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var g=document.getElementsByTagName("script")[0];g.parentNode.insertBefore(h,g)})()}if(GameConfig.TGE.FONT_LOADER){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"Font loader enabled");b.push(a+"font"+e+".js")}if(!GameConfig.NATIVE_APP){b.push(a+"viewporter"+e+".js")}if(GameConfig.TGE.ENABLED){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"TGE-SDK enabled, using version "+GameConfig.TGE.VERSION);b.push(a+"PxLoader"+e+".js");b.push(a+"PxLoaderImage"+e+".js");b.push(a+"tge/tge-"+GameConfig.TGE.VERSION+e+".js")}if(GameConfig.TGS.ENABLED){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"TGS-SDK enabled, using version "+GameConfig.TGS.VERSION);b.push(a+"iscroll-lite"+e+".js");b.push(a+"tgs/tgs-"+GameConfig.TGS.VERSION+e+".js")}if(!GameConfig.NATIVE_APP&&GameConfig.Playnomics.ENABLED){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"Playnomics enabled");b.push(a+"playnomics"+e+".js")}if(GameConfig.DEBUG){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"Loading individual un-minified game class files");GameConfig.SOURCE.forEach(function(g){b.push(g)})}else{if(GameConfig.NATIVE_APP){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"Loading individual un-minified game class files");GameConfig.SOURCE.forEach(function(g){b.push(g)})}else{if(GameConfig.PROD_ENV){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"Minified game code will load from "+d+"js/game/game-"+GameConfig.VERSION+e+".js");b.push(d+"js/game/game-"+GameConfig.VERSION+e+".js")}else{TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"Loading individual un-minified game class files");GameConfig.SOURCE.forEach(function(g){b.push(g)})}}}if(!GameConfig.NATIVE_APP&&GameConfig.Quantcast.ENABLED){TGL.Debug.Log(TGL.Debug.LOG_INFO,"Quantcast enabled");(function(){var h=document.createElement("script");h.src=(document.location.protocol=="https:"?"https://secure":"http://edge")+".quantserve.com/quant.js";h.async=true;h.type="text/javascript";var g=document.getElementsByTagName("script")[0];g.parentNode.insertBefore(h,g)})();_qevents.push({qacct:"p-pFeCqGCfT0VUS"})}TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"Calling head.js.apply to load all javascript libraries");head.js.apply(this,b);head.ready(function(){TGL.Debug.Log(TGL.Debug.LOG_INFO,"All javascript libraries loaded");TGL.setEventListeners()})})();TGL.setEventListeners=function(){_gaq.push(["_setAccount",(GameConfig.PROD_ENV?GameConfig.GoogleAnalytics.PROD_ID:GameConfig.GoogleAnalytics.QA_ID)]);_gaq.push(["_setCustomVar",1,"dst",TGL.getDistributionPartner(),3]);_gaq.push(["_setCustomVar",2,"ver",GameConfig.VERSION,3]);_gaq.push(["_trackPageview"]);if(GameConfig.TGS.ENABLED&&!GameConfig.TGS.ASYNC_LOAD){if(GameConfig.TGS.ENABLED){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"TGSLoaded setting TGS.onReady = TGL.initializeTGE");TGS.onReady=TGL.initializeTGE}TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"Calling TGS.Init - synchronously");TGS.Init(GameConfig.GAME_ID,TGL.getDistributionPartner());if(GameConfig.NATIVE_APP){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"Setting up deviceready event listener to call TGL.TGSLoaded");document.addEventListener("deviceready",TGL.TGSLoaded,false)}else{if(window.addEventListener){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"Setting up windows.addEventListener to call TGL.TGSLoaded");window.addEventListener("load",TGL.TGSLoaded,false)}else{TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"Setting up windows.attachEvent to call TGL.TGSLoaded");window.attachEvent("onload",TGL.TGSLoaded)}}}else{if(GameConfig.TGS.ENABLED&&GameConfig.TGS.ASYNC_LOAD){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"Calling TGS.Init - asynchronously");TGS.Init(GameConfig.GAME_ID,TGL.getDistributionPartner())}if(GameConfig.NATIVE_APP){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"Setting up deviceready event listener to call TGL.initializeTGE");document.addEventListener("deviceready",TGL.initializeTGE,false)}else{if(document.readyState==="complete"){TGL.initializeTGE()}else{if(window.addEventListener){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"Setting up windows.addEventListener to call TGL.initializeTGE");window.addEventListener("load",TGL.initializeTGE,false)}else{TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"Setting up windows.attachEvent to call TGL.initializeTGE");window.attachEvent("onload",TGL.initializeTGE)}}}}};TGL.TGSLoaded=function(){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"TGSLoaded called");window.removeEventListener?window.removeEventListener("load",TGL.initializeTGE,false):window.detachEvent("onload",TGL.initializeTGE);if(TGL.getDistributionPartner()==null||!GameConfig.TGS.ENABLED){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"TGSLoaded calling TGL.initializeTGE. Dst is null or TGS not enabled.");TGL.initializeTGE()}else{if(TGS.IsReady()){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"TGSLoaded calling TGL.initializeTGE. TGS is ready.");TGL.initializeTGE()}else{}}};TGL.initializeTGE=function(){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"initializeTGE called");if(TGL.RanGame){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"Leaving Early/Duplicate call");return}var b=document.getElementById(GameConfig.PRELOADER_DIV);GameConfig.ADSERVER_GAMEOVER_URL=TGL.getAdServerURL(GameConfig.ADS.GAMEOVER_PLACEMENT_ID);GameConfig.ADSERVER_REPLAY_URL=TGL.getAdServerURL(GameConfig.ADS.REPLAY_PLACEMENT_ID);b.style.display="none";GameConfig.MoreGames={};GameConfig.MoreGames.URL=TGL.getMoreGamesURL();GameConfig.MoreGames.ENABLED=!!GameConfig.MoreGames.URL;TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"GameConfig.MoreGames.URL = "+GameConfig.MoreGames.URL);TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"GameConfig.MoreGames.ENABLED = "+GameConfig.MoreGames.ENABLED);var a=new window[GameConfig.CONSTRUCTOR]();if(a.IsPlatformAcceptable()){TGL.RanGame=true;TGL.Debug.Log(TGL.Debug.LOG_INFO,"Launching "+GameConfig.CONSTRUCTOR);a.Launch({gameDiv:GameConfig.CANVAS_ID,orientation:GameConfig.ORIENTATION,reorientDiv:GameConfig.REORIENT_ID,width:GameConfig.WIDTH,height:GameConfig.HEIGHT});if(GameConfig.TGS.ENABLED){TGS.GameLaunched()}}else{TGL.Debug.Log(TGL.Debug.LOG_ERROR,"Game can not be played on this platform")}};TGL.getDistributionPartner=function(){if(typeof CordovaConfig==="undefined"){var a=TGL.getQueryString()["dst"];return(typeof a==="string")?a:null}else{return(typeof CordovaConfig.DST_ID==="string")?CordovaConfig.DST_ID:null}};TGL.getQueryString=function(){var b={},d=location.search.substring(1),c=/([^&=]+)=([^&]*)/g,a;while(a=c.exec(d)){b[decodeURIComponent(a[1])]=decodeURIComponent(a[2])}return b};TGL.getAdServerURL=function(a){var b=(GameConfig.NATIVE_APP)?"http:":"";b+="//adserver.adtechus.com/adiframe/3.0/5421.1/"+a+"/0/170/ADTECH;target=_blank;key="+TGL.getDistributionPartner()+";kvenv="+encodeURIComponent(TGE.BrowserDetect.platform);return b};TGL.getMoreGamesURL=function(){var a=TGL.getQueryString()["moregames"],b=TGL.getDistributionPartner();a=decodeURIComponent(a);if(!TGL.ValidURL(a)){a=null}if(!a&&(!b||b=="A0000")){a="http://www.mobilewebarcade.com"}return a};TGL.ValidURL=function(b){var a=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return a.test(b)};window.applicationCache.onchecking=function(){TGL.Debug.Log(TGL.Debug.LOG_INFO,"AppCache checking for a new version.");return false};window.applicationCache.onnoupdate=function(){TGL.Debug.Log(TGL.Debug.LOG_INFO,"AppCache reports version is up-to-date.");return false};window.applicationCache.ondownloading=function(){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"AppCache downloading new version.");window.progresscount=0;return false};window.applicationCache.onprogress=function(b){var a="";if(b&&b.lengthComputable){a=" "+Math.round(100*b.loaded/b.total)+"%"}else{a=" ("+ ++progresscount+")"}TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"AppCache downloading new version"+a);return false};window.applicationCache.oncached=function(){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"AppCache application is now cached locally.");return false};window.applicationCache.onupdateready=function(){TGL.Debug.Log(TGL.Debug.LOG_VERBOSE,"AppCache new version has been downloaded. Reload to run it.");return false};window.applicationCache.onerror=function(){TGL.Debug.Log(TGL.Debug.LOG_ERROR,"AppCache couldn't load manifest or cache application. appcache status = "+window.applicationCache.status);return false};window.applicationCache.onobsolete=function(){TGL.Debug.Log(TGL.Debug.LOG_ERROR,"This application is no longer cached. Reload to get the latest version from the network.");return false};